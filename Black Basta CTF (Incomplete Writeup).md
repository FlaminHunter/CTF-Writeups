# Black Basta CTF on CyberDefenders platform
A financial employee at OrionTech mistakenly downloaded a ZIP file from an email claiming to be from a trusted vendor. The attachment contained what appeared to be a document, but it initiated a chain of actions that compromised the system and led to a broader network intrusion.
Your objective is to analyze the artifacts left behind, track the attackerâ€™s movements across the environment, and understand the techniques used at each stage of the kill chain.
Black Basta is a known ransomware group that established its presence in April 2022, but the members of that group has since moved on to other known ransomware groups today. Regardless, the Tactics Techniques and Procedures that were emulated by CyberDefenders can assist us in our log analysis skills and how we can effectively manage risk to customer environments. 
# Initial Access
Q1: An employee downloaded a ZIP archive containing a malicious Excel file. What was the full URL used to download this file?
To answer this question, there are several fundamental approaches. We know that the employee has downloaded an excel file from a suspicious website, so we have to think of queries that would enable us to find the host URL. Note, you can use the same approach using ElasticStack as well, albeit the query language is going to be different. Principle is still the same. 
At first, I would dnsquery for that information using Sysmon Event ID 22, because DNS by default translates domain names to IP addresses in which the user can access internet resources from that domain. However, that was rather not effective at least for this answer because I could not find the hosturl. What I ended up doing was asking somebody, in which they suggested to query for Sysmon Event ID 15. 
Sysmon Event ID 15 documents when a new file stream is created, and logs any processes that has been created in which we can hunt for the URL the user accessed. Below is a screenshot that leads us to the answer.
![BlackBastaHostUrl](https://github.com/user-attachments/assets/ded51d13-8410-455b-bbf0-e7bbab7566ac)
Answer: hxxp[://]54[.]93[.]105[.]22/Financial%20Records[.]zip (Defanged for safety reasons).
I would highly recommend you take notes on the Date and Time (3/21/25 at 3:08:41.0000 PM) and the User (FINANCEES\knixon). This is important as the User Knixon got compromised, the time frame allows us to dig deeper into those events created by Windows, which would help track the activity done on the endpoint by the simulated threat actor. Otherwise, good luck into looking at millions of logs and you will never find out what happened. 
